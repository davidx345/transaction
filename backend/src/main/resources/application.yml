spring:
  application:
    name: recon-engine
  datasource:
    url: jdbc:postgresql://localhost:5432/recon_db
    username: postgres
    password: password
    driver-class-name: org.postgresql.Driver
  jpa:
    hibernate:
      ddl-auto: validate
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
  flyway:
    enabled: true
    baseline-on-migrate: true
  rabbitmq:
    host: localhost
    port: 5672
    username: guest
    password: guest

server:
  port: 8080

# Security Configuration
security:
  jwt:
    secret-key: ${JWT_SECRET:dev-secret-key-change-in-production-must-be-at-least-256-bits}
    access-token-expiry: 86400000       # 24 hours in milliseconds
    refresh-token-expiry: 604800000     # 7 days in milliseconds
    issuer: fintech-recon-engine
  rate-limiting:
    enabled: true
    requests-per-minute: 100
    auth-requests-per-minute: 10
    burst-capacity: 150
  cors:
    allowed-origins:
      - http://localhost:3000
      - http://localhost:5173
    allowed-methods:
      - GET
      - POST
      - PUT
      - DELETE
      - OPTIONS
    allowed-headers:
      - "*"
    allow-credentials: true
    max-age: 3600

# Webhook Secrets (for development - use environment variables in production)
webhook:
  paystack-secret-key: ${PAYSTACK_SECRET_KEY:sk_test_xxxxxxx}
  flutterwave-secret-hash: ${FLUTTERWAVE_SECRET_HASH:FLWSECK_TEST-xxxxxxx}
  korapay-secret-key: ${KORAPAY_SECRET_KEY:kp_sk_test_xxxxxxx}
  quidax-secret-key: ${QUIDAX_SECRET_KEY:qdx_sk_test_xxxxxxx}
  fincra-encryption-key: ${FINCRA_ENCRYPTION_KEY:fnc_enc_test_xxxxxxx}
  moniepoint-secret-key: ${MONIEPOINT_SECRET_KEY:mnfy_sk_test_xxxxxxx}

# Reconciliation Matching Configuration
reconciliation:
  amount:
    default-percentage: 0.02       # 2% tolerance for amount matching
    max-absolute: 100.00           # Maximum ₦100 tolerance
    min-amount-for-percentage: 1000.00  # Use percentage for amounts >= ₦1000
  date:
    days-before: 1                 # Look 1 day before transaction
    days-after: 3                  # Look 3 days after (T+1, T+2, T+3)
    skip-weekends: true            # Extend range if weekend falls in window
  confidence:
    auto-match-threshold: 95       # Auto-approve matches >= 95%
    high-confidence-threshold: 85  # Quick review for 85-94%
    medium-confidence-threshold: 70 # Standard review for 70-84%
    low-confidence-threshold: 40   # Detailed review for 40-69%
  weights:
    exact-reference-match: 40      # Points for exact reference
    fuzzy-reference-match: 30      # Points for fuzzy reference
    exact-amount-match: 30         # Points for exact amount
    tolerance-amount-match: 20     # Points for amount within tolerance
    same-day-match: 20             # Points for same-day transaction
    date-range-match: 10           # Points for transaction in date window
    status-match: 10               # Points for matching status
    duplicate-penalty: -20         # Penalty for potential duplicates
  bank-fees:
    gtbank:
      bank-name: GTBank
      fee-percentage: 0.015        # 1.5% fee
      flat-fee: 0
      max-fee: 2000.00
      vat-applied: true
      vat-percentage: 0.075
    access:
      bank-name: Access Bank
      fee-percentage: 0.015
      flat-fee: 50.00
      max-fee: 2500.00
      vat-applied: true
      vat-percentage: 0.075
    zenith:
      bank-name: Zenith Bank
      fee-percentage: 0.01         # 1% fee
      flat-fee: 25.00
      max-fee: 1500.00
      vat-applied: true
      vat-percentage: 0.075
    korapay:
      bank-name: Korapay
      fee-percentage: 0.015        # 1.5% fee
      flat-fee: 0
      max-fee: 2000.00
      vat-applied: true
      vat-percentage: 0.075
    quidax:
      bank-name: Quidax
      fee-percentage: 0.005        # 0.5% for crypto trading
      flat-fee: 0
      max-fee: 50000.00
      vat-applied: false
      vat-percentage: 0
    fincra:
      bank-name: Fincra
      fee-percentage: 0.02         # 2% for cross-border
      flat-fee: 100.00
      max-fee: 5000.00
      vat-applied: true
      vat-percentage: 0.075
    moniepoint:
      bank-name: Moniepoint
      fee-percentage: 0.015        # 1.5% fee
      flat-fee: 0
      max-fee: 2000.00
      vat-applied: true
      vat-percentage: 0.075

